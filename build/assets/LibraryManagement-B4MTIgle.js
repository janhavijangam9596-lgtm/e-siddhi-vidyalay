import{r as x,j as e}from"./ui-vendor-CZ9oH99c.js";import{d as f,B as i,L as o,I as m,S as B,e as w,f as D,g as S,h as a,T as ye,i as Be,j as A,k as E,C as k,c as N,t as h,a as $,b as H,l as M}from"./index-CbaydhWW.js";import{T as le,a as te,b as L,c as n,d as ie,e as r}from"./table-SvwjoT6S.js";import{D as G,a as xe,b as J,c as q,d as K,e as ne}from"./dialog-GASJ86Ds.js";import{T as we}from"./textarea-Drs0EPqH.js";import{P as es}from"./progress-BxpaIchm.js";import{C as De}from"./checkbox-DjQKjGtE.js";import{R as Se,U as Ie,Z as ss,o as as,ad as X,O as ls,s as ts,a4 as is,a0 as Z,a7 as re,a6 as ns,K as ue,q as Fe,ab as rs,ae as os}from"./icons-vendor-WGRqNp00.js";import"./react-vendor-Dazix4UH.js";import"./db-vendor-BlTxHScW.js";import"./charts-vendor-CAKBN1xl.js";function ks(){const[je,me]=x.useState([]),[ve,pe]=x.useState([]),[ge,be]=x.useState([]),[oe,fe]=x.useState([]),[c,ke]=x.useState({totalBooks:0,totalMembers:0,booksIssued:0,overdueBooks:0,reservations:0,fineCollection:0,popularBooks:0,newArrivals:0}),[Te,Ae]=x.useState(!0),[Ee,ce]=x.useState(!1),[Me,z]=x.useState(!1),[Le,de]=x.useState(!1),[Re,Y]=x.useState(!1),[Oe,Q]=x.useState(!1),[u,Pe]=x.useState(null),[R,ze]=x.useState(null),[W,Ye]=x.useState(""),[ee,Ue]=x.useState(""),[se,Ve]=x.useState(""),[Ne,cs]=x.useState(""),[I,Ce]=x.useState(1),[U]=x.useState(10),[F,O]=x.useState([]),[t,g]=x.useState({title:"",author:"",isbn:"",category:"",publisher:"",publishedYear:"",edition:"",language:"English",pages:"",price:"",location:"",shelfNumber:"",totalCopies:"1",description:"",tags:""}),[v,T]=x.useState({name:"",type:"student",class:"",department:"",email:"",phone:"",maxBooks:"3"}),[y,P]=x.useState({bookId:"",studentId:"",dueDate:""}),[C,ae]=x.useState({condition:"good",fineAmount:"",remarks:""});x.useEffect(()=>{b()},[]);const b=async()=>{try{const[s,d,p,j,l]=await Promise.all([f.getBooks().catch(()=>[]),f.getBookIssues().catch(()=>[]),f.getBookReservations().catch(()=>[]),f.getLibraryMembers().catch(()=>[]),f.getLibraryStats().catch(()=>({totalBooks:0,totalMembers:0,booksIssued:0,overdueBooks:0,reservations:0,fineCollection:0,popularBooks:0,newArrivals:0}))]);me(s||[]),pe(d||[]),be(p||[]),fe(j||[]),ke(l||{totalBooks:0,totalMembers:0,booksIssued:0,overdueBooks:0,reservations:0,fineCollection:0,popularBooks:0,newArrivals:0})}catch{const d=[{id:"1",title:"The Great Gatsby",author:"F. Scott Fitzgerald",isbn:"978-0-7432-7356-5",category:"Fiction",publisher:"Scribner",publishedYear:1925,edition:"First",language:"English",pages:180,price:599,location:"Section A",shelfNumber:"A-12",totalCopies:5,availableCopies:3,reservedCopies:1,status:"available",description:"Classic American novel",tags:["classic","fiction","american"],added_at:"2024-01-01"},{id:"2",title:"Introduction to Algorithms",author:"Thomas H. Cormen",isbn:"978-0-262-03384-8",category:"Computer Science",publisher:"MIT Press",publishedYear:2009,edition:"Third",language:"English",pages:1312,price:4500,location:"Section C",shelfNumber:"C-45",totalCopies:3,availableCopies:1,reservedCopies:0,status:"available",description:"Comprehensive textbook on algorithms",tags:["computer science","algorithms","textbook"],added_at:"2024-01-05"},{id:"3",title:"To Kill a Mockingbird",author:"Harper Lee",isbn:"978-0-06-112008-4",category:"Fiction",publisher:"HarperCollins",publishedYear:1960,edition:"First",language:"English",pages:324,price:799,location:"Section A",shelfNumber:"A-15",totalCopies:4,availableCopies:4,reservedCopies:0,status:"available",tags:["classic","fiction","social justice"],added_at:"2024-01-10"}],p=[{id:"1",bookId:"1",bookTitle:"The Great Gatsby",studentId:"STU001",studentName:"John Doe",studentClass:"10th",rollNumber:"101",issueDate:"2024-01-15",dueDate:"2024-01-29",status:"issued",renewalCount:0,created_at:"2024-01-15"},{id:"2",bookId:"2",bookTitle:"Introduction to Algorithms",studentId:"STU002",studentName:"Jane Smith",studentClass:"10th",rollNumber:"102",issueDate:"2024-01-10",dueDate:"2024-01-24",status:"overdue",fineAmount:50,renewalCount:1,created_at:"2024-01-10"}],j=[{id:"1",memberId:"LIB001",name:"John Doe",type:"student",class:"10th",email:"john.doe@school.edu",phone:"+91 98765 43210",joinDate:"2024-01-01",status:"active",maxBooks:3,currentBooks:1,totalFine:0,created_at:"2024-01-01"},{id:"2",memberId:"LIB002",name:"Jane Smith",type:"student",class:"10th",email:"jane.smith@school.edu",phone:"+91 98765 43211",joinDate:"2024-01-01",status:"active",maxBooks:3,currentBooks:1,totalFine:50,created_at:"2024-01-01"}],l={totalBooks:12,totalMembers:2,booksIssued:2,overdueBooks:1,reservations:1,fineCollection:50,popularBooks:3,newArrivals:2};me(d),pe(p),be([]),fe(j),ke(l)}finally{Ae(!1)}},_e=async()=>{try{const s={...t,publishedYear:parseInt(t.publishedYear),pages:parseInt(t.pages),price:parseFloat(t.price),totalCopies:parseInt(t.totalCopies),availableCopies:parseInt(t.totalCopies),reservedCopies:0,status:"available",tags:t.tags.split(",").map(d=>d.trim()).filter(d=>d)};await f.createBook(s),h.success("Book added successfully"),ce(!1),Ke(),b()}catch(s){h.error("Failed to add book"),console.error(s)}},$e=async()=>{try{const s={...v,memberId:`LIB${Date.now()}`,joinDate:new Date().toISOString(),status:"active",maxBooks:parseInt(v.maxBooks),currentBooks:0,totalFine:0};await f.createLibraryMember(s),h.success("Member added successfully"),de(!1),Xe(),b()}catch(s){h.error("Failed to add member"),console.error(s)}},He=async()=>{try{const s={...y,issueDate:new Date().toISOString(),status:"issued",renewalCount:0};await f.issueBook(s),h.success("Book issued successfully"),z(!1),Ze(),b()}catch(s){h.error("Failed to issue book"),console.error(s)}},Ge=async()=>{try{if(!R)return;const s={returnDate:new Date().toISOString(),condition:C.condition,fineAmount:parseFloat(C.fineAmount)||0,remarks:C.remarks,status:C.condition==="damaged"?"damaged":"returned"};await f.returnBook(R.id,s),h.success("Book returned successfully"),Q(!1),Qe(),b()}catch(s){h.error("Failed to return book"),console.error(s)}},Je=async s=>{try{await f.renewBook(s),h.success("Book renewed successfully"),b()}catch(d){h.error("Failed to renew book"),console.error(d)}},qe=async(s,d)=>{try{const p={bookId:s,studentId:d,reservationDate:new Date().toISOString(),expiryDate:new Date(Date.now()+6048e5).toISOString(),status:"active"};await f.reserveBook(p),h.success("Book reserved successfully"),b()}catch(p){h.error("Failed to reserve book"),console.error(p)}},Ke=()=>{g({title:"",author:"",isbn:"",category:"",publisher:"",publishedYear:"",edition:"",language:"English",pages:"",price:"",location:"",shelfNumber:"",totalCopies:"1",description:"",tags:""})},Xe=()=>{T({name:"",type:"student",class:"",department:"",email:"",phone:"",maxBooks:"3"})},Ze=()=>{P({bookId:"",studentId:"",dueDate:""})},Qe=()=>{ae({condition:"good",fineAmount:"",remarks:""})},V=s=>{switch(s){case"available":return"bg-green-100 text-green-800";case"out_of_stock":return"bg-red-100 text-red-800";case"damaged":return"bg-orange-100 text-orange-800";case"lost":return"bg-gray-100 text-gray-800";case"issued":return"bg-blue-100 text-blue-800";case"returned":return"bg-green-100 text-green-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},_=(je||[]).filter(s=>s?((s.title||"").toLowerCase().includes(W.toLowerCase())||(s.author||"").toLowerCase().includes(W.toLowerCase())||(s.isbn||"").toLowerCase().includes(W.toLowerCase()))&&(ee===""||ee==="all"||s.category===ee)&&(se===""||se==="all"||s.status===se)&&(Ne===""||(s.author||"").toLowerCase().includes(Ne.toLowerCase())):!1),We=Math.ceil(_.length/U),he=_.slice((I-1)*U,I*U);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Library Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage books, members, and library operations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",onClick:b,children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),"Refresh"]}),e.jsxs(G,{open:Le,onOpenChange:de,children:[e.jsx(xe,{asChild:!0,children:e.jsxs(i,{variant:"outline",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Add Member"]})}),e.jsxs(J,{children:[e.jsxs(q,{children:[e.jsx(K,{children:"Add Library Member"}),e.jsx(ne,{children:"Register a new library member"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"memberName",children:"Name"}),e.jsx(m,{id:"memberName",value:v.name,onChange:s=>T({...v,name:s.target.value}),placeholder:"Enter member name"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"memberType",children:"Member Type"}),e.jsxs(B,{value:v.type,onValueChange:s=>T({...v,type:s}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Select member type"})}),e.jsxs(S,{children:[e.jsx(a,{value:"student",children:"Student"}),e.jsx(a,{value:"staff",children:"Staff"}),e.jsx(a,{value:"faculty",children:"Faculty"})]})]})]}),v.type==="student"&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"memberClass",children:"Class"}),e.jsxs(B,{value:v.class,onValueChange:s=>T({...v,class:s}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Select class"})}),e.jsxs(S,{children:[e.jsx(a,{value:"1",children:"Class 1"}),e.jsx(a,{value:"2",children:"Class 2"}),e.jsx(a,{value:"3",children:"Class 3"}),e.jsx(a,{value:"4",children:"Class 4"}),e.jsx(a,{value:"5",children:"Class 5"}),e.jsx(a,{value:"6",children:"Class 6"}),e.jsx(a,{value:"7",children:"Class 7"}),e.jsx(a,{value:"8",children:"Class 8"}),e.jsx(a,{value:"9",children:"Class 9"}),e.jsx(a,{value:"10",children:"Class 10"}),e.jsx(a,{value:"11",children:"Class 11"}),e.jsx(a,{value:"12",children:"Class 12"})]})]})]}),(v.type==="staff"||v.type==="faculty")&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"memberDepartment",children:"Department"}),e.jsx(m,{id:"memberDepartment",value:v.department,onChange:s=>T({...v,department:s.target.value}),placeholder:"Enter department"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"memberEmail",children:"Email"}),e.jsx(m,{id:"memberEmail",type:"email",value:v.email,onChange:s=>T({...v,email:s.target.value}),placeholder:"Enter email"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"memberPhone",children:"Phone"}),e.jsx(m,{id:"memberPhone",value:v.phone,onChange:s=>T({...v,phone:s.target.value}),placeholder:"Enter phone number"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"maxBooks",children:"Maximum Books Allowed"}),e.jsx(m,{id:"maxBooks",type:"number",value:v.maxBooks,onChange:s=>T({...v,maxBooks:s.target.value}),placeholder:"Enter maximum books"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsx(i,{onClick:$e,children:"Add Member"})]})]})]}),e.jsxs(G,{open:Ee,onOpenChange:ce,children:[e.jsx(xe,{asChild:!0,children:e.jsxs(i,{children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Add Book"]})}),e.jsxs(J,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(q,{children:[e.jsx(K,{children:"Add New Book"}),e.jsx(ne,{children:"Add a new book to the library collection"})]}),e.jsxs(ye,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Be,{className:"grid w-full grid-cols-3",children:[e.jsx(A,{value:"basic",children:"Basic Info"}),e.jsx(A,{value:"details",children:"Details"}),e.jsx(A,{value:"inventory",children:"Inventory"})]}),e.jsxs(E,{value:"basic",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookTitle",children:"Title"}),e.jsx(m,{id:"bookTitle",value:t.title,onChange:s=>g({...t,title:s.target.value}),placeholder:"Enter book title"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookAuthor",children:"Author"}),e.jsx(m,{id:"bookAuthor",value:t.author,onChange:s=>g({...t,author:s.target.value}),placeholder:"Enter author name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookISBN",children:"ISBN"}),e.jsx(m,{id:"bookISBN",value:t.isbn,onChange:s=>g({...t,isbn:s.target.value}),placeholder:"Enter ISBN"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookCategory",children:"Category"}),e.jsxs(B,{value:t.category,onValueChange:s=>g({...t,category:s}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Select category"})}),e.jsxs(S,{children:[e.jsx(a,{value:"fiction",children:"Fiction"}),e.jsx(a,{value:"non_fiction",children:"Non-Fiction"}),e.jsx(a,{value:"science",children:"Science"}),e.jsx(a,{value:"mathematics",children:"Mathematics"}),e.jsx(a,{value:"history",children:"History"}),e.jsx(a,{value:"biography",children:"Biography"}),e.jsx(a,{value:"reference",children:"Reference"}),e.jsx(a,{value:"textbook",children:"Textbook"}),e.jsx(a,{value:"children",children:"Children's Books"}),e.jsx(a,{value:"literature",children:"Literature"})]})]})]})]})]}),e.jsxs(E,{value:"details",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookPublisher",children:"Publisher"}),e.jsx(m,{id:"bookPublisher",value:t.publisher,onChange:s=>g({...t,publisher:s.target.value}),placeholder:"Enter publisher"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"publishedYear",children:"Published Year"}),e.jsx(m,{id:"publishedYear",type:"number",value:t.publishedYear,onChange:s=>g({...t,publishedYear:s.target.value}),placeholder:"Enter year"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookEdition",children:"Edition"}),e.jsx(m,{id:"bookEdition",value:t.edition,onChange:s=>g({...t,edition:s.target.value}),placeholder:"Enter edition"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookLanguage",children:"Language"}),e.jsxs(B,{value:t.language,onValueChange:s=>g({...t,language:s}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Select language"})}),e.jsxs(S,{children:[e.jsx(a,{value:"English",children:"English"}),e.jsx(a,{value:"Hindi",children:"Hindi"}),e.jsx(a,{value:"Spanish",children:"Spanish"}),e.jsx(a,{value:"French",children:"French"}),e.jsx(a,{value:"German",children:"German"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookPages",children:"Pages"}),e.jsx(m,{id:"bookPages",type:"number",value:t.pages,onChange:s=>g({...t,pages:s.target.value}),placeholder:"Enter page count"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookPrice",children:"Price"}),e.jsx(m,{id:"bookPrice",type:"number",step:"0.01",value:t.price,onChange:s=>g({...t,price:s.target.value}),placeholder:"Enter price"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookDescription",children:"Description"}),e.jsx(we,{id:"bookDescription",value:t.description,onChange:s=>g({...t,description:s.target.value}),placeholder:"Enter book description",rows:3})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookTags",children:"Tags (comma-separated)"}),e.jsx(m,{id:"bookTags",value:t.tags,onChange:s=>g({...t,tags:s.target.value}),placeholder:"Enter tags separated by commas"})]})]}),e.jsxs(E,{value:"inventory",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookLocation",children:"Location"}),e.jsx(m,{id:"bookLocation",value:t.location,onChange:s=>g({...t,location:s.target.value}),placeholder:"Enter location (e.g., Section A)"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"shelfNumber",children:"Shelf Number"}),e.jsx(m,{id:"shelfNumber",value:t.shelfNumber,onChange:s=>g({...t,shelfNumber:s.target.value}),placeholder:"Enter shelf number"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"totalCopies",children:"Total Copies"}),e.jsx(m,{id:"totalCopies",type:"number",value:t.totalCopies,onChange:s=>g({...t,totalCopies:s.target.value}),placeholder:"Enter number of copies"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsx(i,{onClick:_e,children:"Add Book"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(k,{children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Books"}),e.jsx("p",{className:"text-2xl font-bold",children:c.totalBooks})]}),e.jsx(as,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(k,{children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Books Issued"}),e.jsx("p",{className:"text-2xl font-bold",children:c.booksIssued})]}),e.jsx(X,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(k,{children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overdue Books"}),e.jsx("p",{className:"text-2xl font-bold",children:c.overdueBooks})]}),e.jsx(ls,{className:"h-8 w-8 text-red-600"})]})})}),e.jsx(k,{children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Members"}),e.jsx("p",{className:"text-2xl font-bold",children:c.totalMembers})]}),e.jsx(Ie,{className:"h-8 w-8 text-purple-600"})]})})})]}),e.jsxs(ye,{defaultValue:"books",className:"w-full",children:[e.jsxs(Be,{children:[e.jsx(A,{value:"books",children:"Books"}),e.jsx(A,{value:"issues",children:"Issues/Returns"}),e.jsx(A,{value:"members",children:"Members"}),e.jsx(A,{value:"reservations",children:"Reservations"}),e.jsx(A,{value:"reports",children:"Reports"})]}),e.jsxs(E,{value:"books",className:"space-y-4",children:[e.jsx(k,{children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-64",children:e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Search books...",value:W,onChange:s=>Ye(s.target.value),className:"pl-10"})]})}),e.jsxs(B,{value:ee,onValueChange:Ue,children:[e.jsxs(w,{className:"w-48",children:[e.jsx(is,{className:"mr-2 h-4 w-4"}),e.jsx(D,{placeholder:"Filter by category"})]}),e.jsxs(S,{children:[e.jsx(a,{value:"all",children:"All Categories"}),e.jsx(a,{value:"fiction",children:"Fiction"}),e.jsx(a,{value:"non_fiction",children:"Non-Fiction"}),e.jsx(a,{value:"science",children:"Science"}),e.jsx(a,{value:"mathematics",children:"Mathematics"}),e.jsx(a,{value:"textbook",children:"Textbook"})]})]}),e.jsxs(B,{value:se,onValueChange:Ve,children:[e.jsx(w,{className:"w-48",children:e.jsx(D,{placeholder:"Filter by status"})}),e.jsxs(S,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"available",children:"Available"}),e.jsx(a,{value:"out_of_stock",children:"Out of Stock"}),e.jsx(a,{value:"damaged",children:"Damaged"}),e.jsx(a,{value:"lost",children:"Lost"})]})]}),e.jsxs(i,{variant:"outline",onClick:()=>{const s=[["Title","Author","ISBN","Category","Publisher","Year","Available","Total","Status","Location"].join(","),..._.map(l=>[l.title,l.author,l.isbn,l.category,l.publisher,l.publishedYear,l.availableCopies,l.totalCopies,l.status,`${l.location} - ${l.shelfNumber}`].join(","))].join(`
`),d=new Blob([s],{type:"text/csv"}),p=URL.createObjectURL(d),j=document.createElement("a");j.href=p,j.download=`library-books-${Date.now()}.csv`,j.click(),h.success("Books exported successfully")},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Export"]})]}),F.length>0&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-blue-50 rounded-lg mt-4",children:[e.jsxs("span",{className:"text-sm",children:[F.length," books selected"]}),e.jsxs(i,{size:"sm",variant:"outline",onClick:()=>{h.info("Bulk edit functionality coming soon")},children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Bulk Edit"]}),e.jsxs(i,{size:"sm",variant:"outline",onClick:()=>{confirm(`Are you sure you want to delete ${F.length} books?`)&&(h.success(`${F.length} books deleted`),O([]),b())},children:[e.jsx(ns,{className:"mr-2 h-4 w-4"}),"Bulk Delete"]}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>O([]),children:"Clear"})]})]})}),e.jsxs(k,{children:[e.jsx($,{children:e.jsx(H,{children:"Book Collection"})}),e.jsxs(N,{children:[Te?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(te,{children:e.jsxs(L,{children:[e.jsx(n,{className:"w-12",children:e.jsx(De,{checked:F.length===he.length,onCheckedChange:s=>{O(s?he.map(d=>d.id):[])}})}),e.jsx(n,{children:"Title"}),e.jsx(n,{children:"Author"}),e.jsx(n,{children:"Category"}),e.jsx(n,{children:"ISBN"}),e.jsx(n,{children:"Copies"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Location"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(ie,{children:(he||[]).map(s=>e.jsxs(L,{children:[e.jsx(r,{children:e.jsx(De,{checked:F.includes(s.id),onCheckedChange:d=>{O(d?[...F,s.id]:F.filter(p=>p!==s.id))}})}),e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.publisher})]})}),e.jsx(r,{children:s.author}),e.jsx(r,{children:e.jsx(M,{variant:"outline",children:s.category})}),e.jsx(r,{className:"font-mono text-sm",children:s.isbn}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:["Available: ",s.availableCopies]}),e.jsxs("div",{children:["Total: ",s.totalCopies]})]})}),e.jsx(r,{children:e.jsx(M,{className:V(s.status),children:s.status.replace("_"," ")})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:s.location}),e.jsxs("div",{className:"text-muted-foreground",children:["Shelf: ",s.shelfNumber]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{Pe(s),Y(!0)},children:e.jsx(ue,{className:"h-4 w-4"})}),s.availableCopies>0?e.jsx(i,{size:"sm",onClick:()=>{P({...y,bookId:s.id}),z(!0)},title:"Issue this book",children:e.jsx(X,{className:"h-4 w-4"})}):e.jsx(i,{size:"sm",variant:"outline",disabled:!0,title:"Book not available",children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{h.info("Edit book functionality coming soon")},children:e.jsx(re,{className:"h-4 w-4"})})]})})]},s.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(I-1)*U+1," to"," ",Math.min(I*U,_.length)," of"," ",_.length," books"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>Ce(I-1),disabled:I===1,children:"Previous"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>Ce(I+1),disabled:I===We,children:"Next"})]})]})]})]})]}),e.jsxs(E,{value:"issues",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Book Issues & Returns"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",onClick:()=>{const s=[["Book Title","Member Name","Class","Issue Date","Due Date","Status","Fine"].join(","),...(ve||[]).map(l=>[l.bookTitle,l.studentName,l.studentClass,l.issueDate,l.dueDate,l.status,l.fineAmount||"0"].join(","))].join(`
`),d=new Blob([s],{type:"text/csv"}),p=URL.createObjectURL(d),j=document.createElement("a");j.href=p,j.download=`library-issues-${Date.now()}.csv`,j.click(),h.success("Issues exported successfully")},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Export Issues"]}),e.jsxs(G,{open:Me,onOpenChange:z,children:[e.jsx(xe,{asChild:!0,children:e.jsxs(i,{children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Issue Book"]})}),e.jsxs(J,{children:[e.jsxs(q,{children:[e.jsx(K,{children:"Issue Book"}),e.jsx(ne,{children:"Issue a book to a library member"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"issueBook",children:"Select Book"}),e.jsxs(B,{value:y.bookId,onValueChange:s=>P({...y,bookId:s}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Select a book"})}),e.jsx(S,{children:(je||[]).filter(s=>s&&s.availableCopies>0).map(s=>e.jsxs(a,{value:s.id,children:[s.title," - ",s.author," (",s.availableCopies," available)"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"issueStudent",children:"Select Member"}),e.jsxs(B,{value:y.studentId,onValueChange:s=>P({...y,studentId:s}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Select a member"})}),e.jsx(S,{children:(oe||[]).filter(s=>s&&s.status==="active").map(s=>e.jsxs(a,{value:s.id,children:[s.name," (",s.type,") - Books: ",s.currentBooks,"/",s.maxBooks]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"dueDate",children:"Due Date"}),e.jsx(m,{id:"dueDate",type:"date",value:y.dueDate,onChange:s=>P({...y,dueDate:s.target.value})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),e.jsx(i,{onClick:He,children:"Issue Book"})]})]})]})]})]}),e.jsx(k,{children:e.jsx(N,{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(te,{children:e.jsxs(L,{children:[e.jsx(n,{children:"Book"}),e.jsx(n,{children:"Member"}),e.jsx(n,{children:"Issue Date"}),e.jsx(n,{children:"Due Date"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Fine"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(ie,{children:(ve||[]).slice(0,10).map(s=>e.jsxs(L,{children:[e.jsx(r,{children:e.jsx("div",{children:e.jsx("div",{className:"font-medium",children:s.bookTitle})})}),e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.studentName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.studentClass," - ",s.rollNumber]})]})}),e.jsx(r,{children:new Date(s.issueDate).toLocaleDateString()}),e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{children:new Date(s.dueDate).toLocaleDateString()}),s.status==="overdue"&&e.jsxs("div",{className:"text-sm text-red-600",children:[Math.ceil((Date.now()-new Date(s.dueDate).getTime())/(1e3*60*60*24))," days overdue"]})]})}),e.jsx(r,{children:e.jsx(M,{className:V(s.status),children:s.status})}),e.jsx(r,{children:s.fineAmount?`₹${s.fineAmount}`:"-"}),e.jsx(r,{children:e.jsx("div",{className:"flex gap-2",children:s.status==="issued"||s.status==="overdue"?e.jsxs(e.Fragment,{children:[e.jsx(i,{size:"sm",onClick:()=>{ze(s),Q(!0)},title:"Return this book",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>Je(s.id),title:"Renew this book",children:e.jsx(Se,{className:"h-4 w-4"})})]}):e.jsx(i,{size:"sm",variant:"outline",children:e.jsx(ue,{className:"h-4 w-4"})})})})]},s.id))})]})})})})]}),e.jsx(E,{value:"members",className:"space-y-4",children:e.jsxs(k,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between",children:[e.jsx(H,{children:"Library Members"}),e.jsxs(i,{variant:"outline",onClick:()=>{const s=[["Member ID","Name","Type","Class/Dept","Email","Phone","Books Issued","Max Books","Fine","Status"].join(","),...(oe||[]).map(l=>[l.memberId,l.name,l.type,l.class||l.department||"",l.email,l.phone,l.currentBooks,l.maxBooks,l.totalFine,l.status].join(","))].join(`
`),d=new Blob([s],{type:"text/csv"}),p=URL.createObjectURL(d),j=document.createElement("a");j.href=p,j.download=`library-members-${Date.now()}.csv`,j.click(),h.success("Members exported successfully")},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Export Members"]})]}),e.jsx(N,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(te,{children:e.jsxs(L,{children:[e.jsx(n,{children:"Member ID"}),e.jsx(n,{children:"Name"}),e.jsx(n,{children:"Type"}),e.jsx(n,{children:"Class/Department"}),e.jsx(n,{children:"Books Issued"}),e.jsx(n,{children:"Fine Due"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(ie,{children:(oe||[]).map(s=>e.jsxs(L,{children:[e.jsx(r,{className:"font-mono",children:s.memberId}),e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]})}),e.jsx(r,{children:e.jsx(M,{variant:"outline",children:s.type})}),e.jsx(r,{children:s.class||s.department}),e.jsxs(r,{children:[s.currentBooks,"/",s.maxBooks]}),e.jsx(r,{children:s.totalFine>0?e.jsxs("span",{className:"text-red-600",children:["₹",s.totalFine]}):"-"}),e.jsx(r,{children:e.jsx(M,{className:V(s.status),children:s.status})}),e.jsx(r,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{h.info(`Viewing member: ${s.name}`)},children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{h.info("Edit member functionality coming soon")},children:e.jsx(re,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]})}),e.jsx(E,{value:"reservations",className:"space-y-4",children:e.jsxs(k,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between",children:[e.jsx(H,{children:"Book Reservations"}),e.jsxs(i,{variant:"outline",onClick:()=>{const s=[["Book Title","Member Name","Reservation Date","Expiry Date","Status"].join(","),...(ge||[]).map(l=>[l.bookTitle,l.studentName,l.reservationDate,l.expiryDate,l.status].join(","))].join(`
`),d=new Blob([s],{type:"text/csv"}),p=URL.createObjectURL(d),j=document.createElement("a");j.href=p,j.download=`library-reservations-${Date.now()}.csv`,j.click(),h.success("Reservations exported successfully")},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Export Reservations"]})]}),e.jsx(N,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(le,{children:[e.jsx(te,{children:e.jsxs(L,{children:[e.jsx(n,{children:"Book"}),e.jsx(n,{children:"Member"}),e.jsx(n,{children:"Reservation Date"}),e.jsx(n,{children:"Expiry Date"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(ie,{children:(ge||[]).map(s=>e.jsxs(L,{children:[e.jsx(r,{children:s.bookTitle}),e.jsx(r,{children:s.studentName}),e.jsx(r,{children:new Date(s.reservationDate).toLocaleDateString()}),e.jsx(r,{children:new Date(s.expiryDate).toLocaleDateString()}),e.jsx(r,{children:e.jsx(M,{className:V(s.status),children:s.status})}),e.jsx(r,{children:e.jsxs("div",{className:"flex gap-2",children:[s.status==="active"&&e.jsx(i,{size:"sm",onClick:()=>{h.success(`Reservation fulfilled for ${s.bookTitle}`),b()},children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{confirm("Cancel this reservation?")&&(h.success("Reservation cancelled"),b())},children:e.jsx(rs,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]})}),e.jsxs(E,{value:"reports",className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(i,{variant:"outline",onClick:()=>{const s={date:new Date().toISOString(),totalBooks:c.totalBooks,totalMembers:c.totalMembers,booksIssued:c.booksIssued,overdueBooks:c.overdueBooks,reservations:c.reservations,fineCollection:c.fineCollection,availableBooks:c.totalBooks-c.booksIssued,circulationRate:(c.booksIssued/c.totalBooks*100).toFixed(2)+"%"},d=JSON.stringify(s,null,2),p=new Blob([d],{type:"application/json"}),j=URL.createObjectURL(p),l=document.createElement("a");l.href=j,l.download=`library-report-${Date.now()}.json`,l.click(),h.success("Report exported successfully")},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Export Report"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(k,{children:[e.jsx($,{children:e.jsx(H,{children:"Collection Summary"})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Books"}),e.jsx("span",{className:"font-bold",children:c.totalBooks})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Books in Circulation"}),e.jsx("span",{className:"font-bold",children:c.booksIssued})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Available Books"}),e.jsx("span",{className:"font-bold",children:c.totalBooks-c.booksIssued})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Overdue Books"}),e.jsx("span",{className:"font-bold text-red-600",children:c.overdueBooks})]}),e.jsx(es,{value:c.booksIssued/c.totalBooks*100,className:"w-full"}),e.jsxs("div",{className:"text-sm text-center text-muted-foreground",children:[Math.round(c.booksIssued/c.totalBooks*100),"% books in circulation"]})]})})]}),e.jsxs(k,{children:[e.jsx($,{children:e.jsx(H,{children:"Member Statistics"})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Members"}),e.jsx("span",{className:"font-bold",children:c.totalMembers})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Active Reservations"}),e.jsx("span",{className:"font-bold",children:c.reservations})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Fine Collection"}),e.jsxs("span",{className:"font-bold text-green-600",children:["₹",c.fineCollection]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"New Arrivals"}),e.jsx("span",{className:"font-bold",children:c.newArrivals})]})]})})]})]})]})]}),e.jsx(G,{open:Re,onOpenChange:Y,children:e.jsxs(J,{className:"max-w-2xl",children:[e.jsx(q,{children:e.jsx(K,{children:"Book Details"})}),u&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Basic Information"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Title: ",u.title]}),e.jsxs("div",{children:["Author: ",u.author]}),e.jsxs("div",{children:["ISBN: ",u.isbn]}),e.jsxs("div",{children:["Category: ",u.category]}),e.jsxs("div",{children:["Publisher: ",u.publisher]}),e.jsxs("div",{children:["Year: ",u.publishedYear]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Availability"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Total Copies: ",u.totalCopies]}),e.jsxs("div",{children:["Available: ",u.availableCopies]}),e.jsxs("div",{children:["Reserved: ",u.reservedCopies]}),e.jsxs("div",{children:["Location: ",u.location]}),e.jsxs("div",{children:["Shelf: ",u.shelfNumber]}),e.jsxs("div",{children:["Status: ",e.jsx(M,{className:V(u.status),children:u.status})]})]})]})]}),u.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-sm",children:u.description})]}),u.tags&&u.tags.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(u.tags||[]).map((s,d)=>e.jsx(M,{variant:"outline",children:s},d))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",onClick:()=>{Y(!1),h.info("Edit functionality coming soon")},children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Edit Book"]}),e.jsxs(i,{variant:"outline",onClick:()=>{u&&u.availableCopies>0?(P({...y,bookId:u.id}),Y(!1),z(!0)):h.error("This book is not available for issue")},children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Issue Book"]}),e.jsxs(i,{variant:"outline",onClick:()=>{u&&(qe(u.id,"STU-001"),Y(!1))},children:[e.jsx(os,{className:"mr-2 h-4 w-4"}),"Reserve"]})]})]})]})}),e.jsx(G,{open:Oe,onOpenChange:Q,children:e.jsxs(J,{children:[e.jsxs(q,{children:[e.jsx(K,{children:"Return Book"}),e.jsxs(ne,{children:["Process book return for ",R?.studentName]})]}),R&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium",children:R.bookTitle}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Issued on: ",new Date(R.issueDate).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Due: ",new Date(R.dueDate).toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"bookCondition",children:"Book Condition"}),e.jsxs(B,{value:C.condition,onValueChange:s=>ae({...C,condition:s}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Select condition"})}),e.jsxs(S,{children:[e.jsx(a,{value:"good",children:"Good"}),e.jsx(a,{value:"fair",children:"Fair"}),e.jsx(a,{value:"damaged",children:"Damaged"}),e.jsx(a,{value:"lost",children:"Lost"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"fineAmount",children:"Fine Amount (if any)"}),e.jsx(m,{id:"fineAmount",type:"number",step:"0.01",value:C.fineAmount,onChange:s=>ae({...C,fineAmount:s.target.value}),placeholder:"Enter fine amount"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"returnRemarks",children:"Remarks"}),e.jsx(we,{id:"returnRemarks",value:C.remarks,onChange:s=>ae({...C,remarks:s.target.value}),placeholder:"Enter any remarks"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>Q(!1),children:"Cancel"}),e.jsx(i,{onClick:Ge,children:"Process Return"})]})]})})]})}export{ks as LibraryManagement};
